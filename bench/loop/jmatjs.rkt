
(herbie-test (z)
  "Jmat.Real.gamma, branch z > 0.5, with loops"
  (let* ([z* (- z 1)]
         [g 7]
         [t (+ z* (+ g 0.5))])
    (do-list ([x 0.99999999999980993 (+ x (/ p-sub (+ z* i)))])
             ([p-sub (list 676.5203681218851 -1259.1392167224028 771.32342877765313
                           -176.61502916214059 12.507343278686905 -0.13857109526572012
                           9.9843695780195716e-6 1.5056327351493116e-7)]
              [i (list 1 2 3 4 5 6 7 8)])
             (* (sqrt (* pi 2)) (expt t (+ z* 0.5)) (* (exp (- t)) x)))))
(herbie-test (z)
  "Jmat.Real.gamma, branch z < 0.5, with loops"
  (let* ([z* (- (- 1 z) 1)]
         [g 7]
         [t (+ z* (+ g 0.5))])
    (do-list ([x 0.99999999999980993 (+ x (/ p-sub (+ z* i)))])
             ([p-sub (list 676.5203681218851 -1259.1392167224028 771.32342877765313
                           -176.61502916214059 12.507343278686905 -0.13857109526572012
                           9.9843695780195716e-6 1.5056327351493116e-7)]
              [i (list 1 2 3 4 5 6 7 8)])
             (* (/ pi (sin (* pi z)))
                (* (sqrt (* pi 2)) (expt t (+ z* 0.5)) (exp (- t)) x)))))
    
